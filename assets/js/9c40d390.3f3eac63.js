(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{132:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return b}));var a=n(3),o=n(7),r=(n(0),n(159)),i={id:"actions-parameters",title:"Using action parameters"},c={unversionedId:"project-definition/actions-parameters",id:"project-definition/actions-parameters",isDocsHomePage:!1,title:"Using action parameters",description:"OBJECTIVES",source:"@site/docs/project-definition/actions-parameters.md",slug:"/project-definition/actions-parameters",permalink:"/go-mobile/docs/project-definition/actions-parameters",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/project-definition/actions-parameters.md",version:"current"},s=[{value:"STEP 1. Add action",id:"step-1-add-action",children:[]},{value:"STEP 2. Edit action",id:"step-2-edit-action",children:[]},{value:"STEP 3. Delete action",id:"step-3-delete-action",children:[]},{value:"STEP 4. Send a comment action",id:"step-4-send-a-comment-action",children:[]},{value:"STEP 5. Create the On Mobile App Action",id:"step-5-create-the-on-mobile-app-action",children:[]},{value:"STEP 6. Create All the methods you need",id:"step-6-create-all-the-methods-you-need",children:[{value:"addAction",id:"addaction",children:[]},{value:"editAction",id:"editaction",children:[]},{value:"deleteAction",id:"deleteaction",children:[]},{value:"sendEmail",id:"sendemail",children:[]}]},{value:"STEP 7. Build your app",id:"step-7-build-your-app",children:[]},{value:"STEP 8. Where to go from here?",id:"step-8-where-to-go-from-here",children:[]}],l={toc:s};function b(e){var t=e.components,i=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},l,i,{components:t,mdxType:"MDXLayout"}),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},Object(r.b)("strong",{parentName:"p"},"OBJECTIVES")),Object(r.b)("p",{parentName:"blockquote"},"Define action parameters to edit the content of your app.")),Object(r.b)("p",null,"In the ","[previous tutorial]",Object(r.b)("inlineCode",{parentName:"p"},"(define-first-action.html)"),", we discovered how to execute 4D code from an iOS app by defining actions from the ","[Actions section]",Object(r.b)("inlineCode",{parentName:"p"},"(actions.html)"),"."),Object(r.b)("p",null,"In this tutorial, we're going to go further and create:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"an Add action to ",Object(r.b)("strong",{parentName:"li"},"create a new task"),","),Object(r.b)("li",{parentName:"ul"},"an Edit action that will allow you to ",Object(r.b)("strong",{parentName:"li"},"edit existing tasks")," from the iOS app,"),Object(r.b)("li",{parentName:"ul"},"a Delete action to ",Object(r.b)("strong",{parentName:"li"},"delete an entity"),", and"),Object(r.b)("li",{parentName:"ul"},"an action that will enable you to ",Object(r.b)("strong",{parentName:"li"},"email a comment for a specific task"),".")),Object(r.b)("p",null,"To begin, let's first download the ",Object(r.b)("strong",{parentName:"p"},"Starter Project")," based on our existing Tasks iOS app."),Object(r.b)("div",{markdown:"1",style:{textAlign:"center",marginTop:"20px",marginBottom:"20px"}},Object(r.b)("a",{class:"button",href:"https://github.com/4d-for-ios/tutorial-ActionParameters/archive/159a7b73bd3556890a205024af42440faf0b277c.zip"},"STARTER PROJECT")),Object(r.b)("h2",{id:"step-1-add-action"},"STEP 1. Add action"),Object(r.b)("p",null,"Let's begin simple. Open the Tasks mobile project and go directly to the ",Object(r.b)("strong",{parentName:"p"},"Actions section"),". "),Object(r.b)("p",null,Object(r.b)("img",{alt:"Action section",src:n(376).default})),Object(r.b)("p",null,"It's quite empty for the moment... Here is what we want: ",Object(r.b)("strong",{parentName:"p"},"create a new task from the iOS app"),"."),Object(r.b)("p",null,"For this, let's create an action using a preset ",Object(r.b)("strong",{parentName:"p"},"Add")," action:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Click on the arrow in the ",Object(r.b)("strong",{parentName:"li"},"+ button")," at the bottom of the Actions table."),Object(r.b)("li",{parentName:"ul"},"Select the ",Object(r.b)("strong",{parentName:"li"},"Add action for")," option."),Object(r.b)("li",{parentName:"ul"},"Select the ",Object(r.b)("strong",{parentName:"li"},"Task table"),". ")),Object(r.b)("p",null,Object(r.b)("img",{alt:"Add action creation",src:n(377).default})),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"A new action")," named ",Object(r.b)("em",{parentName:"li"},'"addTasks"')," with ",Object(r.b)("em",{parentName:"li"},'"Add..."')," as default label is displayed."),Object(r.b)("li",{parentName:"ul"},"All available ",Object(r.b)("strong",{parentName:"li"},"parameters")," and their ",Object(r.b)("strong",{parentName:"li"},"properties")," are shown in the ",Object(r.b)("strong",{parentName:"li"},"Actions Parameters")," section.")),Object(r.b)("p",null,Object(r.b)("img",{alt:"Add action parameters",src:n(378).default})),Object(r.b)("p",null,"At this point, all ",Object(r.b)("strong",{parentName:"p"},"Add action parameters")," are created automatically and ready to use."),Object(r.b)("h2",{id:"step-2-edit-action"},"STEP 2. Edit action"),Object(r.b)("p",null,"Now let's create an action that will allow you to ",Object(r.b)("strong",{parentName:"p"},"edit your app content"),"."),Object(r.b)("p",null,"For this, we'll create an action using a preset ",Object(r.b)("strong",{parentName:"p"},"Edit")," action:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Click on the arrow in the ",Object(r.b)("strong",{parentName:"li"},"+ button")," at the bottom of the Actions table."),Object(r.b)("li",{parentName:"ul"},"Select the ",Object(r.b)("strong",{parentName:"li"},"Edit action for")," option."),Object(r.b)("li",{parentName:"ul"},"Select the Tasks table. ")),Object(r.b)("p",null,Object(r.b)("img",{alt:"Edit action creation",src:n(379).default})),Object(r.b)("p",null,"At this point, you will see:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"A new action")," named ",Object(r.b)("em",{parentName:"li"},'"editTasks"')," with ",Object(r.b)("em",{parentName:"li"},'"Edit..."')," as the default label."),Object(r.b)("li",{parentName:"ul"},"All available action ",Object(r.b)("strong",{parentName:"li"},"parameters")," and their ",Object(r.b)("strong",{parentName:"li"},"properties")," are displayed in the ",Object(r.b)("strong",{parentName:"li"},"Actions parameters")," section.")),Object(r.b)("p",null,Object(r.b)("img",{alt:"Edit action parameters",src:n(380).default})),Object(r.b)("p",null,"Don't worry, we'll handle the 4D code for these actions later. :-)"),Object(r.b)("h2",{id:"step-3-delete-action"},"STEP 3. Delete action"),Object(r.b)("p",null,"The preset ",Object(r.b)("strong",{parentName:"p"},"Delete")," action creation process is nearly the same as the Edit action:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Click on the arrow in the ",Object(r.b)("strong",{parentName:"li"},"+ button")," at the bottom of the Actions table."),Object(r.b)("li",{parentName:"ul"},"Select the ",Object(r.b)("strong",{parentName:"li"},"Delete action for")," option."),Object(r.b)("li",{parentName:"ul"},"Select the Tasks table. ")),Object(r.b)("p",null,Object(r.b)("img",{alt:"Delete action creation",src:n(381).default})),Object(r.b)("p",null,"At this point, you will see a ",Object(r.b)("strong",{parentName:"p"},"new action")," named ",Object(r.b)("em",{parentName:"p"},'"deleteTasks"')," with ",Object(r.b)("em",{parentName:"p"},'"Remove"')," as the default label."),Object(r.b)("p",null,Object(r.b)("img",{alt:"Delete action",src:n(382).default})),Object(r.b)("p",null,"You don't need to worry about parameters or properties for this type of action."),Object(r.b)("h2",{id:"step-4-send-a-comment-action"},"STEP 4. Send a comment action"),Object(r.b)("p",null,"Now we want to ",Object(r.b)("strong",{parentName:"p"},"send a comment")," to a ",Object(r.b)("strong",{parentName:"p"},"specific email")," depending on a specific task. To do so, click on the + button and create a new action named ",Object(r.b)("strong",{parentName:"p"},"sendComment"),"."),Object(r.b)("p",null,Object(r.b)("img",{alt:"Delete action creation",src:n(383).default})),Object(r.b)("p",null,"Now let's create three parameters:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Click on the + button and select ",Object(r.b)("strong",{parentName:"li"},"Title")," in the Action Parameters list to include it in the email you're going to send."),Object(r.b)("li",{parentName:"ul"},"Create a ",Object(r.b)("strong",{parentName:"li"},"Comment")," parameter and select Text area as the format property."),Object(r.b)("li",{parentName:"ul"},"Create an ",Object(r.b)("strong",{parentName:"li"},"email")," parameter and select Email address as the format property.")),Object(r.b)("p",null,"Your Actions section should look like this:"),Object(r.b)("p",null,Object(r.b)("img",{alt:"Send comment action creation",src:n(384).default})),Object(r.b)("h2",{id:"step-5-create-the-on-mobile-app-action"},"STEP 5. Create the On Mobile App Action"),Object(r.b)("p",null,"As described in the ","[documentation]",Object(r.b)("inlineCode",{parentName:"p"},"(actions.html)"),", click on the Create button to create the ",Object(r.b)("em",{parentName:"p"},"On Mobile App Action")," database method."),Object(r.b)("p",null,"All of your actions will automatically be included in this database method."),Object(r.b)("p",null,"The only thing you need to do is add a reference to your method(s) for the scenario(s) your want to handle."),Object(r.b)("p",null,"Here's the final ",Object(r.b)("em",{parentName:"p"},"On Mobile App Action")," database method:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-4d"},'C_OBJECT($0;$response)\nC_OBJECT($1;$request)\n\nC_OBJECT($o;$context;$request;$result;$parameters)\n\n$request:=$1  // Informations provided by mobile application\n\n$context:=$request.context\n$parameters:=$request.parameters\n\nCase of \n        \n    : ($request.action="addTasks")\n        \n          // Insert here the code for the action "Add\u2026"\n        \n        $o:=New object(\\\n        "dataClass";$context.dataClass;\\\n        "parameters";$parameters)\n        \n        $result:=addAction ($o)\n        \n    : ($request.action="editTasks")\n        \n          // Insert here the code for the action "Edit\u2026"\n        \n        $o:=New object(\\\n        "dataClass";$context.dataClass;\\\n        "ID";$context.entity.primaryKey;\\\n        "parameters";$parameters)\n        \n        $result:=editAction ($o)\n        \n        \n    : ($request.action="deleteTasks")\n        \n          // Insert here the code for the action "Remove"\n        \n        $o:=New object(\\\n        "dataClass";$context.dataClass;\\\n        "ID";$context.entity.primaryKey)\n        \n        $result:=deleteAction ($o)\n        \n    : ($request.action="sendComment")\n        \n          // Insert here the code for the action "Send Comment"\n        \n        $o:=New object(\\\n        "dataClass";$context.dataClass;\\\n        "ID";$context.entity.primaryKey;\\\n        "parameters";$parameters)\n        \n        \n        $result:=sendMail ($o)\n        \n    Else \n        \n          // Unknown action\n        \nEnd case \n\n$0:=$result\n\n')),Object(r.b)("h2",{id:"step-6-create-all-the-methods-you-need"},"STEP 6. Create All the methods you need"),Object(r.b)("h3",{id:"addaction"},"addAction"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-4d"},'C_OBJECT($0)\nC_OBJECT($1)\n\nC_OBJECT($entity;$in;$out)\n\n$in:=$1\n\n$out:=New object("success";False)\n\nIf ($in.dataClass#Null)\n    \n    $entity:=ds.Tasks.new()  //create a reference\n    \n    For each ($key;$in.parameters)\n        \n        $entity[$key]:=$in.parameters[$key]\n        \n    End for each \n    \n    $entity.save()  //save the entity\n    \n    \n    $out.success:=True  // notify App that action success\n    $out.dataSynchro:=True  // notify App to refresh the selection\n    $out.statusText:="Task added"\n    \nElse \n    \n    $out.errors:=New collection("No Selection")\n    \nEnd if \n\n$0:=$out\n\n\n')),Object(r.b)("h3",{id:"editaction"},"editAction"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-4d"},'C_OBJECT($0)\nC_OBJECT($1)\n\nC_OBJECT($dataClass;$entity;$in;$out;$status;$selection)\n\n$in:=$1\n\n$selection:=ds[$in.dataClass].query("ID = :1";String($in.ID))\n\nIf ($selection.length=1)\n    \n    $entity:=$selection[0]\n    \n    For each ($key;$in.parameters)\n        \n        $entity[$key]:=$in.parameters[$key]\n        \n    End for each \n    \n    $status:=$entity.save()\n    \n    $out:=New object\n    \n    If ($status.success)\n        \n        $out.success:=True  // notify App that action success\n        $out.dataSynchro:=True  // notify App to refresh this entity\n        $out.statusText:="Task edited"\n        \n    Else \n        \n        $out:=$status  // return status to the App\n        \n    End if \n    \nElse \n    \n    $out.success:=False  // notify App that action failed\n    \nEnd if \n\n$0:=$out\n\n\n')),Object(r.b)("h3",{id:"deleteaction"},"deleteAction"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-4d"},'\nC_OBJECT($0)\nC_OBJECT($1)\n\nC_OBJECT($dataClass;$entity;$in;$out;$status;$selection)\n\n$in:=$1\n\n$selection:=ds[$in.dataClass].query("ID = :1";String($in.ID))\n\nIf ($selection.length=1)\n    \n    $entity:=$selection.drop()\n    \n    $out:=New object\n    \n    If ($entity.length=0)\n        \n        $out.success:=True  // notify App that action success\n        $out.dataSynchro:=True  // notify App to refresh this entity\n        $out.statusText:="Task deleted"\n        \n    Else \n        \n        $out:=$status  // return status to the App\n        \n    End if \n    \nElse \n    \n    $out.success:=False  // notify App that action failed\n    \nEnd if \n\n$0:=$out\n\n\n')),Object(r.b)("h3",{id:"sendemail"},"sendEmail"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-4d"},'C_OBJECT($0;$out)\nC_OBJECT($1;$in)\n\nC_OBJECT($dataClass;$entity;$selection)\n\n$in:=$1\n\n$selection:=ds[$in.dataClass].query("ID = :1";String($in.ID))\n\nIf ($selection.length=1)\n    \n    $entity:=$selection[0]\n    \n    For each ($key;$in.parameters)\n        \n        $entity[$key]:=$in.parameters[$key]\n        \n    End for each \n    \n    $out:=New object\n    \n    $server:=New object\n    $server.host:="smtp.gmail.com"\n    $server.port:=465\n    $server.user:="test@mail.com"\n    $server.password:="yourPassword"\n    \n    $transporter:=SMTP New transporter($server)\n    \n    $email:=New object\n    $email.subject:="New comment about one of your task"\n    $email.from:="yourEmail"\n    $email.to:=$emailToSend\n    $email.htmlBody:="<h1>Comment from Tasks for iOS</h1>"+"<p><b>Task:</b> "+$taskTitle+"</p><p><b>Comment:</b> "\\\n    +$commentToSend+"</p><br><p><i>Send from my 4D for iOS app</i></p>"\\\n    \n    $status:=$transporter.send($email)\n    If ($status.success)\n        $out.success:=True  // notify App that action success\n        $out.statusText:="Mail sent"\n        \n    Else \n        $out.success:=False  // notify App that action failed\n        $out.statusText:="Mail not sent"\n        \n    End if \n    \nElse \n    \n    $out.success:=False  // notify App that action failed\n    \nEnd if \n\n$0:=$out\n\n\n')),Object(r.b)("p",null,"Don't forget to add your own values for the ",Object(r.b)("strong",{parentName:"p"},"sendEmail")," action."),Object(r.b)("h2",{id:"step-7-build-your-app"},"STEP 7. Build your app"),Object(r.b)("p",null,"It's time to build your app! "),Object(r.b)("p",null,"Now, if you click on the Action button in the navigation bar, you'll be able to ",Object(r.b)("strong",{parentName:"p"},"create a new task"),"."),Object(r.b)("p",null,Object(r.b)("img",{alt:"Create new task",src:n(385).default})),Object(r.b)("p",null,"Holding and maintaining pressure on your new task cell in the List Form, will show that an ",Object(r.b)("strong",{parentName:"p"},"Edit...")," action is available in the action list."),Object(r.b)("p",null,Object(r.b)("img",{alt:"Edit task",src:n(386).default})),Object(r.b)("p",null,"Send a comment using the ",Object(r.b)("strong",{parentName:"p"},"Send comment")," action."),Object(r.b)("p",null,Object(r.b)("img",{alt:"Send task comment",src:n(193).default})),Object(r.b)("p",null,"And finally you can delete an entity using the ",Object(r.b)("strong",{parentName:"p"},"Delete...")," action."),Object(r.b)("p",null,Object(r.b)("img",{alt:"Delete task",src:n(387).default})),Object(r.b)("h2",{id:"step-8-where-to-go-from-here"},"STEP 8. Where to go from here?"),Object(r.b)("p",null,"Congratulations! Your Tasks iOS app is now complete and you can now modify your app data direclty from your device and sychronize it with your server!"),Object(r.b)("div",{markdown:"1",style:{textAlign:"center",marginTop:"20px",marginBottom:"20px"}},Object(r.b)("a",{class:"button",href:"https://github.com/4d-for-ios/tutorial-ActionParameters/archive/0.0.1.zip"},"FINAL PROJECT")))}b.isMDXComponent=!0},159:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),o=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=o.a.createContext({}),b=function(e){var t=o.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},p=function(e){var t=b(e.components);return o.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},u=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=b(n),u=a,m=p["".concat(i,".").concat(u)]||p[u]||d[u]||r;return n?o.a.createElement(m,c(c({ref:t},l),{},{components:n})):o.a.createElement(m,c({ref:t},l))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=u;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var l=2;l<r;l++)i[l]=n[l];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},193:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Action-parameters-sendComment-38be2e5b75e0d4d74a51bfcdbb9b9bbe.png"},376:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Actions-section-cbff48a3e62d88ec605631bbd9ba94ab.png"},377:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Add-action-creation-0b90971de150764707c792de82bc1274.png"},378:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Add-action-parameters-6637a821be3f6403d87c129f8e743ae4.png"},379:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Edit-action-creation-f689b0deae347fdfb387ea5c00fc948c.png"},380:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Edit-action-parameters-2a98e90962f2e091508fb5cb07f0969c.png"},381:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Delete-action-creation-a87770233be15d7fd5e9149b7e7f2b3a.png"},382:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Delete-action-final-0d1c7e9df3f531e38cf24a36c0817f98.png"},383:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Send-comment-action-creation-b165dabf7bcb94dffad8e3e13a2ac49b.png"},384:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Send-comment-action-definition-306647a0a7cc4b3e1413dd4013c73d5c.png"},385:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Action-parameters-addAction-ab555a7585002e427fdbe40cc7f313ee.png"},386:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Action-parameters-editAction-9b9ce4f23f7b5a861fe7d24a00eb32cc.png"},387:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/Action-parameters-deleteAction-bc5b8f70ba39268879c57ae0efb5eb82.png"}}]);